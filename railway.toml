[build]
builder = "NIXPACKS"

[deploy]
healthcheckPath = "/ping"
healthcheckTimeout = 30000
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 10

startCommand = "java -jar target/laptopshop-0.0.1-SNAPSHOT.jar --spring.profiles.active=prod"

[[services]]
name = "app"

[services.variables]
PORT = "8080"
SPRING_DATASOURCE_URL = "jdbc:postgresql://${{RAILWAY_PRIVATE_DOMAIN}:5432/railway"
SPRING_DATASOURCE_USERNAME = "${{POSTGRES_USER}}"
SPRING_DATASOURCE_PASSWORD = "${{POSTGRES_PASSWORD}}"
SPRING_JPA_HIBERNATE_DDL_AUTO = "update"
SPRING_JPA_DATABASE_PLATFORM = "org.hibernate.dialect.PostgreSQLDialect"
SERVER_ADDRESS = "0.0.0.0"